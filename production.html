<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>Production | FarmerBase BP Engine</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
body{font-family:system-ui, sans-serif;background:#f4f6f8;margin:0}
.container{max-width:900px;margin:auto;padding:16px}
h2{margin-top:0}
.card{background:#fff;border-radius:8px;padding:12px;margin-bottom:12px}
.row{display:flex;gap:8px;flex-wrap:wrap}
input,select,textarea,button{
  padding:8px;border:1px solid #ccc;border-radius:6px
}
button{cursor:pointer}
.btn{background:#2e7d32;color:#fff;border:none}
.btn-red{background:#c62828;color:#fff;border:none}
.small{font-size:13px;color:#666}
.list-item{border:1px solid #ddd;border-radius:6px;margin-bottom:8px}
.list-head{padding:10px;background:#eef3ef;display:flex;justify-content:space-between;cursor:pointer}
.list-body{display:none;padding:10px}
.list-body.show{display:block}
footer{text-align:center;color:#666;margin:20px 0}
</style>
</head>

<body>
<div class="container">

<h2>рдЙрддреНрдкрд╛рджрди рд╡рд┐рд╡рд░рдг (Production)</h2>
<p class="small">рдпрд╣рд╛рдБ рдердкрд┐рдПрдХрд╛ рдЙрддреНрдкрд╛рджрди/рд╕реЗрд╡рд╛рд╣рд░реВ рдиреИ Expenses рд░ Income рдХреЛ рдЖрдзрд╛рд░ рд╣реБрдиреНрдЫрдиреНред</p>

<!-- ADD FORM -->
<div class="card">
  <div class="row">
    <select id="ptype">
      <option value="">рдЙрддреНрдкрд╛рджрди рдкреНрд░рдХрд╛рд░</option>
      <option>рдХреГрд╖рд┐</option>
      <option>рдкрд╢реБ</option>
      <option>рд╕реЗрд╡рд╛</option>
      <option>рдЕрдиреНрдп</option>
    </select>

    <input id="pname" placeholder="рдЙрддреНрдкрд╛рджрди / рд╕реЗрд╡рд╛ рдирд╛рдо">
    <input id="punit" placeholder="рдЗрдХрд╛рдИ (рдХреЗрдЬреА, рд▓рд┐рдЯрд░, рд╡рдЯрд╛)">
    <input id="pqty" type="number" placeholder="рдкрд░рд┐рдорд╛рдг">
  </div>

  <div class="row" style="margin-top:8px">
    <textarea id="pnote" placeholder="рдХреИрдлрд┐рдпрдд / рд╡рд┐рд╡рд░рдг" style="width:100%"></textarea>
  </div>

  <button class="btn" style="margin-top:10px" onclick="addProduct()">+ рдЙрддреНрдкрд╛рджрди рдердкреНрдиреБрд╣реЛрд╕реН</button>
</div>

<!-- SEARCH -->
<input id="search" placeholder="ЁЯФН рдЦреЛрдЬреНрдиреБрд╣реЛрд╕реН" oninput="render()" style="width:100%;margin-bottom:10px">

<!-- LIST -->
<div id="list"></div>

<!-- NAV -->
<div class="row" style="justify-content:space-between;margin-top:20px">
  <button onclick="location.href='business-detail.html'">тмЕя╕П Business Detail</button>
  <button onclick="location.href='expenses.html'">Expenses тЮбя╕П</button>
</div>

<footer>FarmerBase BP Engine</footer>
</div>

<script>
let products = JSON.parse(localStorage.getItem("fb_products")) || [];

function save(){
  localStorage.setItem("fb_products", JSON.stringify(products));
}

function uid(){
  return "p"+Date.now();
}

function addProduct(){
  if(!ptype.value || !pname.value || !punit.value || !pqty.value){
    alert("рд╕рдмреИ рдореБрдЦреНрдп рд╡рд┐рд╡рд░рдг рднрд░реНрдиреБрд╣реЛрд╕реН");
    return;
  }

  products.unshift({
    id: uid(),
    type: ptype.value,
    name: pname.value,
    unit: punit.value,
    qty: Number(pqty.value),
    note: pnote.value
  });

  ptype.value=pname.value=punit.value=pqty.value=pnote.value="";
  save(); render();
}

function remove(id){
  if(confirm("рд╣рдЯрд╛рдЙрдиреЗ?")){
    products = products.filter(p=>p.id!==id);
    save(); render();
  }
}

function toggle(id){
  document.getElementById(id).classList.toggle("show");
}

function render(){
  const q = search.value?.toLowerCase() || "";
  list.innerHTML="";

  products
  .filter(p=>p.name.toLowerCase().includes(q))
  .forEach(p=>{
    const d=document.createElement("div");
    d.className="list-item";
    d.innerHTML=`
      <div class="list-head" onclick="toggle('${p.id}')">
        <b>${p.name}</b>
        <span>${p.qty} ${p.unit}</span>
      </div>
      <div class="list-body" id="${p.id}">
        <div class="small">рдкреНрд░рдХрд╛рд░: ${p.type}</div>
        <div class="small">рдХреИрдлрд┐рдпрдд: ${p.note||"-"}</div>
        <button class="btn-red" onclick="remove('${p.id}')">рд╣рдЯрд╛рдЙрдиреБрд╣реЛрд╕реН</button>
      </div>
    `;
    list.appendChild(d);
  });
}

render();
</script>
</body>
</html>

