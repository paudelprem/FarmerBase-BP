<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>Income | FarmerBase BP Engine</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body{font-family:system-ui;background:#f4f6f8;margin:0}
header{background:#2e7d32;color:#fff;padding:10px 16px;font-size:18px}
.container{max-width:1100px;margin:auto;padding:16px;padding-bottom:90px}
.box{background:#fff;border-radius:8px;padding:16px;margin-bottom:20px}
h2{margin-top:0}
input,button{padding:6px;font-size:14px}
button{cursor:pointer}
.green{background:#2e7d32;color:#fff;border:0;border-radius:4px;padding:6px 10px}
table{width:100%;border-collapse:collapse;margin-top:10px}
th,td{border-bottom:1px solid #ddd;padding:6px;text-align:left}
.right{text-align:right}
.small{font-size:13px;color:#555}
footer{
  position:fixed;left:0;right:0;bottom:0;
  background:#f1f8f4;border-top:1px solid #ccc;
  padding:8px 12px;display:flex;justify-content:space-between
}
</style>
</head>

<body>
<header>FarmerBase BP Engine тАУ Income</header>

<div class="container">

<!-- ===== INFO ===== -->
<div class="box">
  <b>рдЖрдореНрджрд╛рдиреА рд╡рд┐рд╡рд░рдг</b><br>
  рдЙрддреНрдкрд╛рджрди рд╡рд╛ рд╕реЗрд╡рд╛рдХреЛ рдмрд┐рдХреНрд░реА рдкрд░рд┐рдорд╛рдг рд░ рдореВрд▓реНрдпрдХреЛ рдЖрдзрд╛рд░рдорд╛ рдЖрдореНрджрд╛рдиреА рдЧрдгрдирд╛ рдЧрд░рд┐рдиреНрдЫред
</div>

<!-- ===== ADD INCOME ===== -->
<div class="box">
  <h2>рдЖрдореНрджрд╛рдиреА рд╕реНрд░реЛрдд рдердкреНрдиреБрд╣реЛрд╕реН</h2>
  <input id="iName" placeholder="рдЙрддреНрдкрд╛рджрди / рд╕реЗрд╡рд╛ рдирд╛рдо">
  <input id="iQty" type="number" placeholder="рдкрд░рд┐рдорд╛рдг">
  <input id="iRate" type="number" placeholder="рдкреНрд░рддрд┐ рдЗрдХрд╛рдИ рдореВрд▓реНрдп">
  <button class="green" onclick="addIncome()">+ рдердкреНрдиреБрд╣реЛрд╕реН</button>
</div>

<!-- ===== LIST ===== -->
<div class="box">
  <h2>рдЖрдореНрджрд╛рдиреА рд╕реВрдЪреА</h2>
  <table>
    <thead>
      <tr>
        <th>рдЙрддреНрдкрд╛рджрди / рд╕реЗрд╡рд╛</th>
        <th>рдкрд░рд┐рдорд╛рдг</th>
        <th>рджрд░</th>
        <th class="right">рдЬрдореНрдорд╛</th>
        <th></th>
      </tr>
    </thead>
    <tbody id="incomeList"></tbody>
  </table>
</div>

<!-- ===== SUMMARY ===== -->
<div class="box">
  <b>рдХреБрд▓ рдЖрдореНрджрд╛рдиреА:</b>
  <span id="totalIncome">0.00</span>
</div>

</div>

<!-- ===== FOOTER NAV ===== -->
<footer>
  <button onclick="location.href='capital-source.html'">тмЕя╕П</button>
  <button onclick="goNext()">тЮбя╕П</button>
</footer>

<script>
/* ========= DATA ========= */
let incomes = JSON.parse(localStorage.getItem("fb_income")) || [];

/* ========= ADD ========= */
function addIncome(){
  const name = iName.value.trim();
  const qty  = +iQty.value || 0;
  const rate = +iRate.value || 0;

  if(!name || !qty || !rate){
    alert("рдирд╛рдо, рдкрд░рд┐рдорд╛рдг рд░ рджрд░ рдЕрдирд┐рд╡рд╛рд░реНрдп");
    return;
  }

  incomes.push({ name, qty, rate });
  iName.value = iQty.value = iRate.value = "";
  render();
}

/* ========= REMOVE ========= */
function removeIncome(i){
  if(confirm("рд╣рдЯрд╛рдЙрдиреЗ?")){
    incomes.splice(i,1);
    render();
  }
}

/* ========= RENDER ========= */
function render(){
  let total = 0;
  incomeList.innerHTML = "";

  incomes.forEach((it,i)=>{
    const amt = it.qty * it.rate;
    total += amt;
    incomeList.innerHTML += `
      <tr>
        <td>${it.name}</td>
        <td>${it.qty}</td>
        <td>${it.rate}</td>
        <td class="right">${amt.toFixed(2)}</td>
        <td><button onclick="removeIncome(${i})">тЬЦ</button></td>
      </tr>
    `;
  });

  totalIncome.innerText = total.toFixed(2);

  // ЁЯФЧ AUTO SYNC FOR PROFITтАУLOSS
  localStorage.setItem(
    "fb_income_summary",
    JSON.stringify({ total })
  );
}

/* ========= NEXT ========= */
function goNext(){
  if(!incomes.length){
    alert("рдХрдореНрддреАрдорд╛ рдПрдХ рдЖрдореНрджрд╛рдиреА рд╕реНрд░реЛрдд рдердкреНрдиреБрд╣реЛрд╕реН");
    return;
  }
  location.href = "profit-loss.html";
}

render();
</script>

</body>
</html>
