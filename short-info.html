<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Short Info | FarmerBase BP Engine</title>

<style>
*{box-sizing:border-box}
body{margin:0;font-family:system-ui;background:#f6f7f9;color:#222}
:root{--w:980px;--g:#1b5e20;--b:#ddd}

/* HEADER */
.header{
  position:sticky;top:0;z-index:100;
  background:#fff;border-bottom:1px solid var(--b)
}
.header-inner{
  max-width:var(--w);margin:auto;padding:10px 14px
}
.header h1{margin:0;font-size:16px}
.header .sub{font-size:12px;color:#555}

/* NAV */
.nav-bar{
  max-width:var(--w);margin:8px auto;padding:0 14px;
  display:flex;justify-content:space-between
}
.nav-btn{
  text-decoration:none;font-size:13px;padding:6px 14px;
  border-radius:20px;border:1px solid #ccc;
  background:#fafafa;color:#222
}
.nav-btn.primary{background:var(--g);color:#fff;border-color:var(--g)}

/* MAIN */
.main{max-width:var(--w);margin:10px auto 20px;padding:0 14px;position:relative;z-index:2}
.card{background:#fff;border:1px solid var(--b);border-radius:8px;margin-bottom:16px}
.card h3{
  margin:0;padding:10px 12px;background:#f3f5f7;
  border-bottom:1px solid var(--b);font-size:14px
}
.card .body{padding:12px;font-size:13px}

label{display:block;margin-top:8px}
input,textarea{
  width:100%;padding:6px;margin-top:4px;
  border:1px solid #ccc;border-radius:6px;font-size:13px
}
textarea{resize:vertical}
.small{font-size:11px;color:#555}

/* MAP */
.map-wrap{margin-top:8px;border:1px solid #ddd;border-radius:8px;overflow:hidden}
.map-wrap iframe{width:100%;height:260px;border:0}

/* PRINT */
@media print{
  .nav-bar{display:none}
  body{background:#fff}
}
</style>
</head>

<body>

<!-- HEADER -->
<div class="header">
  <div class="header-inner">
    <h1 id="pageTitle">рдкрд░рд┐рдпреЛрдЬрдирд╛рдХреЛ рдирд╛рдо</h1>
    <div class="sub" id="pageSub">рд╡реНрдпрд╡рд╕рд╛рдп / рд╕рдВрд╕реНрдерд╛рдХреЛ рдирд╛рдо</div>
  </div>
</div>

<!-- TOP NAV -->
<div class="nav-bar">
  <span></span>
  <a href="existing-status.html" class="nav-btn primary">тЮбя╕П рдЕрдЧрд╛рдбрд┐</a>
</div>

<div class="main">

<!-- PROJECT & BUSINESS -->
<div class="card">
  <h3>ЁЯПв рд╡реНрдпрд╡рд╕рд╛рдп рд░ рдкрд░рд┐рдпреЛрдЬрдирд╛</h3>
  <div class="body">

    <label>рд╡реНрдпрд╡рд╕рд╛рдп / рд╕рдВрд╕реНрдерд╛рдХреЛ рдирд╛рдо</label>
    <input id="businessName">

    <label>рдкрд░рд┐рдпреЛрдЬрдирд╛рдХреЛ рдирд╛рдо</label>
    <input id="projectName">

    <label>рдкрд░рд┐рдпреЛрдЬрдирд╛рдХреЛ рд╕рдВрдХреНрд╖рд┐рдкреНрдд рдкрд░рд┐рдЪрдп</label>
    <textarea id="projectIntro" rows="3"></textarea>

  </div>
</div>

<!-- OWNER & REGISTRATION -->
<div class="card">
  <h3>ЁЯУД рджрд░реНрддрд╛ рддрдерд╛ рд╕рдЮреНрдЪрд╛рд▓рдХ рд╡рд┐рд╡рд░рдг</h3>
  <div class="body">

    <label>рдкреНрд░реЛрдкреНрд░рд╛рдЗрдЯрд░ / рд╕рдЮреНрдЪрд╛рд▓рдХрдХреЛ рдирд╛рдо</label>
    <input id="ownerName">

    <label>рд╕рдореНрдкрд░реНрдХ рдирдореНрдмрд░</label>
    <input id="ownerPhone" placeholder="репреоxxxxxxxx">

    <label>рджрд░реНрддрд╛ рдорд┐рддрд┐</label>
    <input type="date" id="regDate">

    <label>рджрд░реНрддрд╛ рдирдВ</label>
    <input id="regNo">

    <label>рджрд░реНрддрд╛ рдирд┐рдХрд╛рдп</label>
    <input id="regOffice" placeholder="рдЬрд╕реНрддреИ: рдЧрд╛рдЙрдБрдкрд╛рд▓рд┐рдХрд╛ / рдирдЧрд░рдкрд╛рд▓рд┐рдХрд╛">

    <label>PAN / VAT рдирдВ</label>
    <input id="panNo">

  </div>
</div>

<!-- ADDRESS & MAP -->
<div class="card">
  <h3>ЁЯУН рдареЗрдЧрд╛рдирд╛ рддрдерд╛ Google рдирдХреНрд╕рд╛</h3>
  <div class="body">

    <label>рдареЗрдЧрд╛рдирд╛ (рдкреВрд░рд╛)</label>
    <textarea id="address" rows="2"
      placeholder="рдкреНрд░рджреЗрд╢, рдЬрд┐рд▓реНрд▓рд╛, рдкрд╛рд▓рд┐рдХрд╛, рд╡рдбрд╛, рдЯреЛрд▓"></textarea>

    <label>Google Map рд▓рд┐рдВрдХ (Paste рдЧрд░реНрдиреБрд╣реЛрд╕реН)</label>
    <input id="mapLink"
      placeholder="https://www.google.com/maps/place/...">

    <div class="map-wrap" id="mapWrap" style="display:none">
      <iframe id="mapFrame" loading="lazy" referrerpolicy="no-referrer-when-downgrade"></iframe>
    </div>

    <div class="small">
      тД╣я╕П Google Maps рдорд╛ рд╕реНрдерд╛рди рдЦреЛрдЬреЗрд░ тАЬShare тЖТ Copy linkтАЭ рдЧрд░реА рдпрд╣рд╛рдБ paste рдЧрд░реНрдиреБрд╣реЛрд╕реНред
    </div>

  </div>
</div>

</div>

<!-- BOTTOM NAV -->
<div class="nav-bar">
  <span></span>
  <a href="existing-status.html" class="nav-btn primary">тЮбя╕П existing-status</a>
</div>

<script>
/* ======================
   CONTEXT
====================== */
let B = JSON.parse(localStorage.getItem("fb_businesses")||"null");
if(!B){ B={activeId:"b1",list:{}}; localStorage.setItem("fb_businesses",JSON.stringify(B)); }
const BID = B.activeId;

/* ======================
   DATA STORE
====================== */
const KEY = "fb_short_info_" + BID;
let data = JSON.parse(localStorage.getItem(KEY) || "null");
if(!data){
  data = {
    businessName:"",
    projectName:"",
    projectIntro:"",
    ownerName:"",
    ownerPhone:"",
    regDate:"",
    regNo:"",
    regOffice:"",
    panNo:"",
    address:"",
    mapLink:""
  };
}

/* ======================
   ELEMENTS
====================== */
const els = {
  businessName: document.getElementById("businessName"),
  projectName: document.getElementById("projectName"),
  projectIntro: document.getElementById("projectIntro"),
  ownerName: document.getElementById("ownerName"),
  ownerPhone: document.getElementById("ownerPhone"),
  regDate: document.getElementById("regDate"),
  regNo: document.getElementById("regNo"),
  regOffice: document.getElementById("regOffice"),
  panNo: document.getElementById("panNo"),
  address: document.getElementById("address"),
  mapLink: document.getElementById("mapLink")
};

const pageTitle = document.getElementById("pageTitle");
const pageSub   = document.getElementById("pageSub");
const mapWrap   = document.getElementById("mapWrap");
const mapFrame  = document.getElementById("mapFrame");

/* ======================
   LOAD
====================== */
Object.keys(els).forEach(k=>{ els[k].value = data[k] || ""; });
updateHeader();
updateMap();

/* ======================
   SAVE (ON BLUR)
====================== */
function save(){
  Object.keys(els).forEach(k=> data[k] = els[k].value);
  localStorage.setItem(KEY, JSON.stringify(data));
  updateHeader();
}
Object.values(els).forEach(el=>{
  el.addEventListener("blur", save);
});

/* ======================
   HEADER AUTO INJECT
====================== */
function updateHeader(){
  pageTitle.textContent = data.projectName || "рдкрд░рд┐рдпреЛрдЬрдирд╛рдХреЛ рдирд╛рдо";
  pageSub.textContent   = data.businessName || "рд╡реНрдпрд╡рд╕рд╛рдп / рд╕рдВрд╕реНрдерд╛рдХреЛ рдирд╛рдо";
  document.title =
    (data.projectName || "") +
    (data.businessName ? " | " + data.businessName : "");
}

/* ======================
   MAP EMBED
====================== */
function updateMap(){
  if(!data.mapLink){ mapWrap.style.display="none"; return; }

  let src = "";
  if(data.mapLink.includes("embed")){
    src = data.mapLink;
  }else{
    // convert share link to embed search
    src = "https://www.google.com/maps?q=" +
          encodeURIComponent(data.mapLink) +
          "&output=embed";
  }
  mapFrame.src = src;
  mapWrap.style.display="block";
}
els.mapLink.addEventListener("blur", ()=>{
  save(); updateMap();
});
</script>

</body>
</html>
