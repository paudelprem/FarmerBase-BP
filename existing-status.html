<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>‡§∏‡•ç‡§•‡§ø‡§§‡§ø ‡§§‡§•‡§æ ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§ß‡§æ‡§∞ | FarmerBase BP Engine</title>

<style>
*{box-sizing:border-box}
body{margin:0;font-family:system-ui;background:#f6f7f9;color:#222}
:root{--w:980px;--g:#1b5e20;--b:#ddd}

/* NAV */
.nav-bar{
  max-width:var(--w);margin:8px auto;padding:8px 14px;
  display:flex;justify-content:space-between
}
.nav-btn{
  text-decoration:none;font-size:13px;padding:6px 14px;
  border-radius:20px;border:1px solid #ccc;
  background:#fafafa;color:#222
}
.nav-btn.primary{background:var(--g);color:#fff;border-color:var(--g)}
.top-nav{position:sticky;top:0;background:#f6f7f9;z-index:9}
.bottom-nav{position:sticky;bottom:0;background:#f6f7f9;z-index:9}

/* Layout */
.main{max-width:var(--w);margin:10px auto 20px;padding:0 14px}
.card{background:#fff;border:1px solid var(--b);border-radius:8px;margin-bottom:16px}
.card h3{
  margin:0;padding:10px 12px;background:#f3f5f7;
  border-bottom:1px solid var(--b);font-size:14px
}
.card .body{padding:12px;font-size:13px}

.status-row{
  display:flex;justify-content:space-between;
  padding:6px 0;border-bottom:1px dashed #eee
}
.status-ok{color:#2e7d32;font-weight:600}
.status-warn{color:#e65100;font-weight:600}

textarea,input{
  width:100%;padding:6px;margin:4px 0;
  border:1px solid #ccc;border-radius:6px;font-size:13px
}

.check{display:flex;align-items:center;gap:8px;margin:6px 0}
</style>
</head>

<body>

<!-- üîº TOP NAV -->
<div class="nav-bar top-nav">
  <a href="short-info.html" class="nav-btn">‚¨ÖÔ∏è ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä</a>
  <a href="business-detail.html" class="nav-btn primary">‚û°Ô∏è ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§µ‡§ø‡§µ‡§∞‡§£</a>
</div>

<div class="main">

<!-- 1Ô∏è‚É£ SHORT-INFO SUMMARY -->
<div class="card">
  <h3>üè¢ ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø‡§ï‡•ã ‡§Ü‡§ß‡§æ‡§∞‡§≠‡•Ç‡§§ ‡§∏‡•ç‡§•‡§ø‡§§‡§ø</h3>
  <div class="body">
    <div class="status-row">
      <span>‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø‡§ï‡•ã ‡§®‡§æ‡§Æ</span>
      <strong id="bizName">‚Äî</strong>
    </div>
    <div class="status-row">
      <span>‡§∏‡§Ç‡§∏‡•ç‡§•‡§æ‡§ó‡§§ ‡§™‡§∞‡§ø‡§ö‡§Ø</span>
      <strong id="introStatus">‚Äî</strong>
    </div>
    <div class="status-row">
      <span>‡§¶‡§∞‡•ç‡§§‡§æ / ‡§ï‡§æ‡§®‡•Å‡§®‡•Ä ‡§µ‡§ø‡§µ‡§∞‡§£</span>
      <strong id="regStatus">‚Äî</strong>
    </div>
    <div class="status-row">
      <span>‡§∏‡§Æ‡•ç‡§™‡§∞‡•ç‡§ï ‡§µ‡§ø‡§µ‡§∞‡§£</span>
      <strong id="contactStatus">‚Äî</strong>
    </div>
  </div>
</div>

<!-- 2Ô∏è‚É£ INFRASTRUCTURE (NEW) -->
<div class="card">
  <h3>üîå ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø‡§∏‡§Å‡§ó ‡§∏‡§Æ‡•ç‡§¨‡§®‡•ç‡§ß‡§ø‡§§ ‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§ß‡§æ‡§∞ ‡§Ö‡§µ‡§∏‡•ç‡§•‡§æ</h3>
  <div class="body">

    <label>‡§™‡•Ç‡§∞‡•ç‡§µ‡§æ‡§ß‡§æ‡§∞‡§ï‡•ã ‡§∏‡§Æ‡§ó‡•ç‡§∞ ‡§Ö‡§µ‡§∏‡•ç‡§•‡§æ (‡§∏‡§Ç‡§ï‡•ç‡§∑‡•á‡§™ Paragraph)</label>
    <textarea id="infraText" rows="3"
      placeholder="‡§∏‡§°‡§ï, ‡§¨‡§ø‡§ú‡•Å‡§≤‡•Ä, ‡§™‡§æ‡§®‡•Ä, ‡§¨‡§ú‡§æ‡§∞‡§ï‡•ã ‡§Ö‡§µ‡§∏‡•ç‡§•‡§æ ‡§∏‡§Ç‡§ï‡•ç‡§∑‡•á‡§™‡§Æ‡§æ..."></textarea>

    <div class="check">
      <input type="checkbox" id="road"> <label for="road">‡§™‡§ï‡•ç‡§ï‡•Ä / ‡§ï‡§ö‡•ç‡§ö‡•Ä ‡§∏‡§°‡§ï ‡§™‡§π‡•Å‡§Å‡§ö</label>
    </div>
    <div class="check">
      <input type="checkbox" id="electricity"> <label for="electricity">‡§¨‡§ø‡§ú‡•Å‡§≤‡•Ä ‡§∏‡•Å‡§µ‡§ø‡§ß‡§æ</label>
    </div>
    <div class="check">
      <input type="checkbox" id="water"> <label for="water">‡§™‡§æ‡§®‡•Ä ‡§∏‡•Å‡§µ‡§ø‡§ß‡§æ</label>
    </div>
    <div class="check">
      <input type="checkbox" id="market"> <label for="market">‡§®‡§ú‡§ø‡§ï‡§ï‡•ã ‡§¨‡§ú‡§æ‡§∞ ‡§™‡§π‡•Å‡§Å‡§ö</label>
    </div>
    <div class="check">
      <input type="checkbox" id="internet"> <label for="internet">‡§á‡§®‡•ç‡§ü‡§∞‡§®‡•á‡§ü / ‡§Æ‡•ã‡§¨‡§æ‡§á‡§≤ ‡§∏‡§û‡•ç‡§ú‡§æ‡§≤</label>
    </div>

  </div>
</div>

</div>

<!-- üîΩ BOTTOM NAV -->
<div class="nav-bar bottom-nav">
  <a href="short-info.html" class="nav-btn">‚¨ÖÔ∏è ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§ú‡§æ‡§®‡§ï‡§æ‡§∞‡•Ä</a>
  <a href="business-detail.html" class="nav-btn primary">‚û°Ô∏è ‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§µ‡§ø‡§µ‡§∞‡§£</a>
</div>

<script>
/* ======================
   LOAD SHORT-INFO STATUS
====================== */
const B = JSON.parse(localStorage.getItem("fb_businesses")||"{}");
const BID = B.activeId || "b1";

/* Short info */
const info = JSON.parse(localStorage.getItem("fb_short_info_"+BID)||"{}");

bizName.textContent = info.name || "‡§≠‡§∞‡§ø‡§è‡§ï‡•ã ‡§õ‡•à‡§®";

introStatus.textContent = info.intro ? "‡§™‡•Ç‡§∞‡§æ" : "‡§Ö‡§ß‡•Ç‡§∞‡•ã";
introStatus.className = info.intro ? "status-ok" : "status-warn";

const regOk = info.registration &&
  (info.registration.office || info.registration.number || info.registration.pan);
regStatus.textContent = regOk ? "‡§™‡•Ç‡§∞‡§æ" : "‡§Ö‡§ß‡•Ç‡§∞‡•ã";
regStatus.className = regOk ? "status-ok" : "status-warn";

const contactOk = info.contact &&
  (info.contact.owner || info.contact.phone);
contactStatus.textContent = contactOk ? "‡§™‡•Ç‡§∞‡§æ" : "‡§Ö‡§ß‡•Ç‡§∞‡•ã";
contactStatus.className = contactOk ? "status-ok" : "status-warn";

/* ======================
   INFRASTRUCTURE SAVE
====================== */
const INFRA_KEY = "fb_infrastructure_" + BID;

function collectInfra(){
  return {
    paragraph: infraText.value,
    checklist:{
      road: road.checked,
      electricity: electricity.checked,
      water: water.checked,
      market: market.checked,
      internet: internet.checked
    }
  };
}

function saveInfra(){
  localStorage.setItem(INFRA_KEY, JSON.stringify(collectInfra()));
}

document.querySelectorAll("#infraText, #road, #electricity, #water, #market, #internet")
  .forEach(e=>{
    e.addEventListener("input", saveInfra);
    e.addEventListener("change", saveInfra);
  });

/* Load infra */
const infra = JSON.parse(localStorage.getItem(INFRA_KEY)||"{}");
infraText.value = infra.paragraph || "";
if(infra.checklist){
  road.checked = !!infra.checklist.road;
  electricity.checked = !!infra.checklist.electricity;
  water.checked = !!infra.checklist.water;
  market.checked = !!infra.checklist.market;
  internet.checked = !!infra.checklist.internet;
}
</script>

</body>
</html>
