<!DOCTYPE html>
<html lang="ne">
<head>
<meta charset="UTF-8">
<title>Business Detail ‚Äì FarmerBase BP Engine</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body{margin:0;font-family:system-ui;background:#f5f7fa}
.container{max-width:900px;margin:auto;padding:20px}
.card{background:#fff;padding:20px;border-radius:8px}
h2{margin-top:0;color:#1b5e20}
.section{border:1px solid #ddd;border-radius:6px;padding:12px;margin-top:12px}
.section h4{margin:0;color:#2e7d32}
.section p{margin:6px 0 0;line-height:1.6}
.actions{margin-top:6px}
.actions button{margin-right:6px}

input,textarea{
  width:100%;
  padding:8px;
  margin-top:6px;
  font-family:inherit;
}

.g-header{
  display:flex;align-items:center;gap:10px;
  padding:10px;background:#1b5e20;color:#fff;
}
.g-header button{background:none;border:none;color:#fff;font-size:18px}
.g-title{flex:1;text-align:center}

.g-footer{
  display:flex;justify-content:space-between;
  padding:10px;border-top:1px solid #ccc;
}
.g-footer button{
  padding:8px 14px;border-radius:20px;
  border:none;background:#1b5e20;color:#fff;
}
</style>
</head>

<body>

<!-- GLOBAL HEADER -->
<header class="g-header">
  <button id="prevTop" onclick="goPrev()">‚¨ÖÔ∏è</button>
  <div class="g-title">
    <div id="bizHdr"></div>
    <small id="projHdr"></small>
  </div>
  <button id="nextTop" onclick="goNext()">‚û°Ô∏è</button>
</header>

<div class="container">
<div class="card">

<h2>‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø ‡§µ‡§ø‡§µ‡§∞‡§£ (Business Detail)</h2>

<!-- ADD NEW -->
<label><b>‡§µ‡§ø‡§∑‡§Ø / ‡§∂‡•Ä‡§∞‡•ç‡§∑‡§ï</b></label>
<input id="newTitle" placeholder="‡§ú‡§∏‡•ç‡§§‡•à: ‡§¨‡§ú‡§æ‡§∞‡§ï‡•ã ‡§π‡§æ‡§≤‡§ï‡•ã ‡§Ö‡§µ‡§∏‡•ç‡§•‡§æ">

<label><b>‡§µ‡§ø‡§µ‡§∞‡§£</b></label>
<textarea id="newDesc" rows="4"
placeholder="‡§Ø‡§∏ ‡§µ‡§ø‡§∑‡§Ø‡§Æ‡§æ ‡§™‡•ç‡§∞‡§∏‡•ç‡§§‡§æ‡§µ‡§ï‡•ã ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§≤‡•á‡§ñ‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç"></textarea>

<button style="margin-top:10px" onclick="addSection()">‚ûï ‡§•‡§™‡•ç‡§®‡•Å‡§π‡•ã‡§∏‡•ç</button>

<hr>

<!-- LIST -->
<div id="list"></div>

</div>
</div>

<!-- GLOBAL FOOTER -->
<footer class="g-footer">
  <button id="prevBottom" onclick="goPrev()">‚¨ÖÔ∏è ‡§Ö‡§ò‡§ø‡§≤‡•ç‡§≤‡•ã</button>
  <button id="nextBottom" onclick="goNext()">‡§Ö‡§∞‡•ç‡§ï‡•ã ‚û°Ô∏è</button>
</footer>

<script>
/* ===== GLOBAL NAV ===== */
const flow=[
"index.html","short-info.html","existing-status.html",
"business-detail.html","production.html","expenses.html",
"capital-source.html","income.html","profit-loss.html",
"executive-summary.html","cover.html"
];
const current=location.pathname.split("/").pop();
const idx=flow.indexOf(current);

function goPrev(){ if(idx>0) location.href=flow[idx-1]; }
function goNext(){ if(idx<flow.length-1) location.href=flow[idx+1]; }

if(idx<=0){prevTop.disabled=prevBottom.disabled=true;}
if(idx>=flow.length-1){nextTop.disabled=nextBottom.disabled=true;}

/* ===== HEADER DATA ===== */
const meta=JSON.parse(localStorage.getItem("fb_meta")||"{}");
bizHdr.textContent=meta.business||"‡§µ‡•ç‡§Ø‡§µ‡§∏‡§æ‡§Ø";
projHdr.textContent=meta.project||"‡§™‡§∞‡§ø‡§Ø‡•ã‡§ú‡§®‡§æ";

/* ===== DATA ===== */
const KEY="fb_business_detail";
let data=JSON.parse(localStorage.getItem(KEY)||"[]");

function render(){
  list.innerHTML="";
  data.forEach((d,i)=>{
    const div=document.createElement("div");
    div.className="section";
    div.innerHTML=`
      <h4>${d.title}</h4>
      <p>${d.desc}</p>
      <div class="actions">
        <button onclick="editSection(${i})">‚úèÔ∏è ‡§∏‡§ö‡•ç‡§Ø‡§æ‡§â‡§®‡•Å</button>
        <button onclick="delSection(${i})">üóëÔ∏è ‡§π‡§ü‡§æ‡§â‡§®‡•Å</button>
      </div>`;
    list.appendChild(div);
  });
}
render();

/* ===== CRUD ===== */
function addSection(){
  if(!newTitle.value || !newDesc.value){
    alert("‡§µ‡§ø‡§∑‡§Ø ‡§∞ ‡§µ‡§ø‡§µ‡§∞‡§£ ‡§Ö‡§®‡§ø‡§µ‡§æ‡§∞‡•ç‡§Ø ‡§õ");
    return;
  }
  data.push({title:newTitle.value, desc:newDesc.value});
  newTitle.value=""; newDesc.value="";
  save();
}

function editSection(i){
  const t=prompt("‡§µ‡§ø‡§∑‡§Ø ‡§∏‡§ö‡•ç‡§Ø‡§æ‡§â‡§®‡•Å‡§π‡•ã‡§∏‡•ç",data[i].title);
  if(t===null) return;
  const d=prompt("‡§µ‡§ø‡§µ‡§∞‡§£ ‡§∏‡§ö‡•ç‡§Ø‡§æ‡§â‡§®‡•Å‡§π‡•ã‡§∏‡•ç",data[i].desc);
  if(d===null) return;
  data[i]={title:t, desc:d};
  save();
}

function delSection(i){
  if(confirm("‡§π‡§ü‡§æ‡§â‡§®‡•á ‡§π‡•ã?")){
    data.splice(i,1);
    save();
  }
}

function save(){
  localStorage.setItem(KEY,JSON.stringify(data));
  render();
}
</script>

</body>
</html>
